
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>dorado.particle_track &#8212; dorado 2.5.0 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="dorado.lagrangian_walker" href="lagrangianwalker.html" />
    <link rel="prev" title="API Reference" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-dorado.particle_track">
<span id="dorado-particle-track"></span><span id="particletrack"></span><h1>dorado.particle_track<a class="headerlink" href="#module-dorado.particle_track" title="Permalink to this headline">¶</a></h1>
<p>Lower-level methods to manage parameters and particle movement.</p>
<p>Particle class for managing the definition of particle attributes and
parameters of the domain as well as iterative movement of the particles
through the domain.</p>
<p>Project Homepage: <a class="reference external" href="https://github.com/passaH2O/dorado">https://github.com/passaH2O/dorado</a></p>
<dl class="class">
<dt id="dorado.particle_track.Particles">
<em class="property">class </em><code class="descclassname">dorado.particle_track.</code><code class="descname">Particles</code><span class="sig-paren">(</span><em>params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dorado/particle_track.html#Particles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dorado.particle_track.Particles" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for the particle(s) that is(are) going to be routed.</p>
<dl class="method">
<dt id="dorado.particle_track.Particles.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dorado/particle_track.html#Particles.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dorado.particle_track.Particles.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Check input parameters and assign default values where/if needed.</p>
<p>Methods require a class of parameters
(<a class="reference internal" href="#dorado.particle_track.modelParams" title="dorado.particle_track.modelParams"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dorado.particle_track.modelParams</span></code></a>) to be passed
to the Particles class. e.g. particle = Particles(modelParams)</p>
<p>Initialization tries to assign each value from the parameter class,
otherwise an error is raised or default values are assigned when
possible/sensible</p>
</dd></dl>

<dl class="attribute">
<dt id="dorado.particle_track.Particles.__weakref__">
<code class="descname">__weakref__</code><a class="headerlink" href="#dorado.particle_track.Particles.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="method">
<dt id="dorado.particle_track.Particles.clear_walk_data">
<code class="descname">clear_walk_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dorado/particle_track.html#Particles.clear_walk_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dorado.particle_track.Particles.clear_walk_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Manually reset self.walk_data back to None.</p>
</dd></dl>

<dl class="method">
<dt id="dorado.particle_track.Particles.generate_particles">
<code class="descname">generate_particles</code><span class="sig-paren">(</span><em>Np_tracer</em>, <em>seed_xloc</em>, <em>seed_yloc</em>, <em>seed_time=0</em>, <em>method='random'</em>, <em>previous_walk_data=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dorado/particle_track.html#Particles.generate_particles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dorado.particle_track.Particles.generate_particles" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a set of particles in defined locations.</p>
<p>After a <a class="reference internal" href="#dorado.particle_track.Particles" title="dorado.particle_track.Particles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dorado.particle_track.Particles</span></code></a> class has been
initialized, this function can be called to create some particles
within a given region. If particles are to be seeded in different
groupings in different regions, this function can be called multiple
times in succession prior to moving them via
<code class="xref py py-obj docutils literal notranslate"><span class="pre">dorado.particle_track.run_iteration</span></code>.</p>
<p>Walk data is stored within <a class="reference internal" href="#dorado.particle_track.Particles" title="dorado.particle_track.Particles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dorado.particle_track.Particles</span></code></a> as
<cite>Particles.walk_data</cite> so if this method is called in succession, even
without the <cite>previous_walk_data</cite> flag, the new particle seed locations
will be appended to the <cite>walk_data</cite> attribute of
<a class="reference internal" href="#dorado.particle_track.Particles" title="dorado.particle_track.Particles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dorado.particle_track.Particles</span></code></a>.</p>
<p><strong>Inputs</strong> :</p>
<blockquote>
<div><dl>
<dt>Np_tracer<span class="classifier"><cite>int</cite></span></dt><dd><p>Number of particles to generate.</p>
</dd>
<dt>seed_xloc<span class="classifier"><cite>list</cite></span></dt><dd><p>List of x-coordinates over which to initially distribute the
particles.</p>
</dd>
<dt>seed_yloc<span class="classifier"><cite>list</cite></span></dt><dd><p>List of y-coordinates over which to initially distribute the
particles.</p>
</dd>
<dt>seed_time<span class="classifier"><cite>float</cite>, <cite>int</cite>, optional</span></dt><dd><p>Seed time to apply to all newly seeded particles. This can be
useful if you are generating new particles and adding them to
a pre-existing set of particles and you want to run them in
a group to a “target-time”. The default value is 0, as new
particles have not traveled for any time, but a savy user
might have need to seed this value with something else.</p>
</dd>
<dt>method<span class="classifier"><cite>str</cite>, optional</span></dt><dd><p>Specify the type of particle generation you wish to use.
Current options are ‘random’ and ‘exact’ for seeding particles
either randomly across a set of points, or exactly at a set
of defined locations. If unspecified, the default is ‘random’.</p>
</dd>
<dt>previous_walk_data<span class="classifier"><cite>dict</cite>, optional</span></dt><dd><p>Dictionary of all prior x locations, y locations, and travel
times. This input parameter should only be used if ‘new’ or
‘indpendent’ walk data exists (e.g. data loaded from a .json
file). Otherwise the walk data stored in <cite>self.walk_data</cite> is
likely to contain the previous information. Order of indices is
previous_walk_data[field][particle][iter], where e.g.
[‘travel_times’][5][10] is the travel time of the 5th particle
at the 10th iteration.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="dorado.particle_track.Particles.run_iteration">
<code class="descname">run_iteration</code><span class="sig-paren">(</span><em>target_time=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dorado/particle_track.html#Particles.run_iteration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dorado.particle_track.Particles.run_iteration" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an iteration of the particle routing.</p>
<p>Runs an iteration of the particle routing.
Returns at each step the particle’s locations and travel times.</p>
<p><strong>Inputs</strong> :</p>
<blockquote>
<div><dl>
<dt>target_time<span class="classifier"><cite>float</cite>, optional</span></dt><dd><p>The travel time (seconds) each particle should aim to have at
end of this iteration. If left undefined, then just one
iteration is run and the particles will be out of sync in time.
Note that this loop will terminate before the target_time if
the particle exceeds the hard-coded limit of 1e4 steps</p>
</dd>
</dl>
</div></blockquote>
<p><strong>Outputs</strong> :</p>
<blockquote>
<div><dl>
<dt>all_walk_data<span class="classifier"><cite>dict</cite></span></dt><dd><p>Dictionary of all x and y locations and travel times. Order of
indices is previous_walk_data[field][particle][iter],
where [‘travel_times’][5][10] is the travel time of the 5th
particle at the 10th iteration</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="dorado.particle_track.coord2ind">
<code class="descclassname">dorado.particle_track.</code><code class="descname">coord2ind</code><span class="sig-paren">(</span><em>coordinates</em>, <em>raster_origin</em>, <em>raster_size</em>, <em>cellsize</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dorado/particle_track.html#coord2ind"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dorado.particle_track.coord2ind" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert geographical coordinates into raster index coordinates.</p>
<p>Assumes geographic coordinates are projected onto a Cartesian grid.
Accepts coordinates in meters or decimal degrees.</p>
<p><strong>Inputs</strong> :</p>
<blockquote>
<div><dl>
<dt>coordinates<span class="classifier"><cite>list</cite></span></dt><dd><p>List [] of (x,y) pairs or tuples of coordinates to be
converted from starting units (e.g. meters UTM) into raster
index coordinates used in particle routing functions.</p>
</dd>
<dt>raster_origin<span class="classifier"><cite>tuple</cite></span></dt><dd><p>Tuple of the (x,y) raster origin in physical space, i.e. the
coordinates of lower left corner. For rasters loaded from a
GeoTIFF, lower left corner can be obtained using e.g. gdalinfo</p>
</dd>
<dt>raster_size<span class="classifier"><cite>tuple</cite></span></dt><dd><p>Tuple (L,W) of the raster dimensions, i.e. the output of
numpy.shape(raster).</p>
</dd>
<dt>cellsize<span class="classifier"><cite>float or int</cite></span></dt><dd><p>Length along one square cell face.</p>
</dd>
</dl>
</div></blockquote>
<p><strong>Outputs</strong> :</p>
<blockquote>
<div><dl>
<dt>inds<span class="classifier"><cite>list</cite></span></dt><dd><p>List [] of tuples (x,y) of raster index coordinates</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="dorado.particle_track.exposure_time">
<code class="descclassname">dorado.particle_track.</code><code class="descname">exposure_time</code><span class="sig-paren">(</span><em>walk_data</em>, <em>region_of_interest</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dorado/particle_track.html#exposure_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dorado.particle_track.exposure_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure exposure time distribution of particles in a specified region.</p>
<p>Function to measure the exposure time distribution (ETD) of particles to
the specified region. For steady flows, the ETD is exactly equivalent to
the residence time distribution. For unsteady flows, if particles make
multiple excursions into the region, all of those times are counted.</p>
<p><strong>Inputs</strong> :</p>
<blockquote>
<div><dl>
<dt>walk_data<span class="classifier"><cite>dict</cite></span></dt><dd><p>Output of a previous function call to run_iteration.</p>
</dd>
<dt>region_of_interest<span class="classifier"><cite>int array</cite></span></dt><dd><p>Binary array the same size as input arrays in modelParams class
with 1’s everywhere inside the region in which we want to
measure exposure time, and 0’s everywhere else.</p>
</dd>
</dl>
</div></blockquote>
<p><strong>Outputs</strong> :</p>
<blockquote>
<div><dl>
<dt>exposure_times<span class="classifier"><cite>list</cite></span></dt><dd><p>List of exposure times to region of interest, listed
in order of particle ID.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="dorado.particle_track.gen_input_check">
<code class="descclassname">dorado.particle_track.</code><code class="descname">gen_input_check</code><span class="sig-paren">(</span><em>Np_tracer</em>, <em>seed_xloc</em>, <em>seed_yloc</em>, <em>seed_time</em>, <em>method</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dorado/particle_track.html#gen_input_check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dorado.particle_track.gen_input_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the inputs provided to <code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_particles()</span></code>.</p>
<p>This function does input type checking and either succeeds or returns
an error if the types provided cannot be converted to those that we
expect in <code class="xref py py-obj docutils literal notranslate"><span class="pre">dorado.particle_track.generate_particles()</span></code>.</p>
<p><strong>Inputs</strong> :</p>
<blockquote>
<div><dl>
<dt>Np_tracer<span class="classifier"><cite>int</cite></span></dt><dd><p>Number of particles to generate.</p>
</dd>
<dt>seed_xloc<span class="classifier"><cite>list</cite></span></dt><dd><p>List of x-coordinates over which to initially distribute the
particles</p>
</dd>
<dt>seed_yloc<span class="classifier"><cite>list</cite></span></dt><dd><p>List of y-coordinates over which to initially distribute the
particles</p>
</dd>
<dt>seed_time<span class="classifier"><cite>int</cite>, <cite>float</cite></span></dt><dd><p>Value to set as initial travel time for newly seeded particles.</p>
</dd>
<dt>method<span class="classifier"><cite>str</cite>, optional</span></dt><dd><p>Type of particle generation to use, either ‘random’ or ‘exact’.</p>
</dd>
</dl>
</div></blockquote>
<p><strong>Outputs</strong> :</p>
<blockquote>
<div><dl>
<dt>Np_tracer<span class="classifier"><cite>int</cite></span></dt><dd><p>Number of particles to generate.</p>
</dd>
<dt>seed_xloc<span class="classifier"><cite>list</cite></span></dt><dd><p>List of x-coordinates over which to initially distribute the
particles</p>
</dd>
<dt>seed_yloc<span class="classifier"><cite>list</cite></span></dt><dd><p>List of y-coordinates over which to initially distribute the
particles</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="dorado.particle_track.ind2coord">
<code class="descclassname">dorado.particle_track.</code><code class="descname">ind2coord</code><span class="sig-paren">(</span><em>walk_data</em>, <em>raster_origin</em>, <em>raster_size</em>, <em>cellsize</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dorado/particle_track.html#ind2coord"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dorado.particle_track.ind2coord" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert raster index coordinates into geographical coordinates.</p>
<p>Appends the walk_data dictionary from the output of run_iteration
with additional fields ‘xcoord’ and ‘ycoord’ in projected geographic
coordinate space. Locations align with cell centroids.
Units of output coordinates match those of raster_origin and cellsize,
can be meters or decimal degrees.</p>
<p><strong>Inputs</strong> :</p>
<blockquote>
<div><dl>
<dt>walk_data<span class="classifier"><cite>dict</cite></span></dt><dd><p>Dictionary of all prior x locations, y locations, and travel
times (the output of run_iteration)</p>
</dd>
<dt>raster_origin<span class="classifier"><cite>tuple</cite></span></dt><dd><p>Tuple of the (x,y) raster origin in physical space, i.e. the
coordinates of lower left corner. For rasters loaded from a
GeoTIFF, lower left corner can be obtained using e.g. gdalinfo</p>
</dd>
<dt>raster_size<span class="classifier"><cite>tuple</cite></span></dt><dd><p>Tuple (L,W) of the raster dimensions, i.e. the output of
numpy.shape(raster).</p>
</dd>
<dt>cellsize<span class="classifier"><cite>float or int</cite></span></dt><dd><p>Length along one square cell face.</p>
</dd>
</dl>
</div></blockquote>
<p><strong>Outputs</strong> :</p>
<blockquote>
<div><dl>
<dt>walk_data<span class="classifier"><cite>dict</cite></span></dt><dd><p>Same as the input walk_data dictionary, with the added
‘xcoord’ and ‘ycoord’ fields representing the particles
geographic position at each iteration.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="class">
<dt id="dorado.particle_track.modelParams">
<em class="property">class </em><code class="descclassname">dorado.particle_track.</code><code class="descname">modelParams</code><a class="reference internal" href="../_modules/dorado/particle_track.html#modelParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dorado.particle_track.modelParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameter class with attributes and grid particles will be routed on.</p>
<p>The parameters class, <a class="reference internal" href="#dorado.particle_track.modelParams" title="dorado.particle_track.modelParams"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dorado.particle_track.modelParams</span></code></a>,
must be populated with user-defined
attributes of the grid the particles will be modeled on.</p>
<p><strong>Required Parameters:</strong></p>
<blockquote>
<div><dl>
<dt>dx<span class="classifier"><cite>float</cite></span></dt><dd><p>Length along one square cell face</p>
</dd>
<dt>depth<span class="classifier"><cite>numpy.ndarray</cite></span></dt><dd><p>Array of water depth values, if absent then the stage and
topography arrays will be used to compute it</p>
</dd>
<dt>stage<span class="classifier"><cite>numpy.ndarray</cite></span></dt><dd><p>Array of water stage values, if absent then the depth and
topography arrays will be used to compute it</p>
</dd>
<dt>qx<span class="classifier"><cite>numpy.ndarray</cite></span></dt><dd><p>Array of the x-component of flow discharge</p>
</dd>
<dt>qy<span class="classifier"><cite>numpy.ndarray</cite></span></dt><dd><p>Array of the y-component of flow discharge</p>
</dd>
<dt>u<span class="classifier"><cite>numpy.ndarray</cite></span></dt><dd><p>Array of the x-component of flow velocity</p>
</dd>
<dt>v<span class="classifier"><cite>numpy.ndarray</cite></span></dt><dd><p>Array of the y-component of flow velocity</p>
</dd>
</dl>
</div></blockquote>
<p><strong>Optional Parameters:</strong></p>
<blockquote>
<div><dl>
<dt>topography<span class="classifier"><cite>numpy.ndarray</cite></span></dt><dd><p>Array of cell elevation values</p>
</dd>
<dt>model<span class="classifier"><cite>str</cite></span></dt><dd><p>Name of the hydrodynamic model input being used (e.g. ‘DeltaRCM’)</p>
</dd>
<dt>theta<span class="classifier"><cite>float</cite></span></dt><dd><p>First of two weighting parameters for the weighted random walk.
Default value is 1.0, higher values give higher weighting
probabilities to cells with greater water depths</p>
</dd>
<dt>gamma<span class="classifier"><cite>float</cite></span></dt><dd><p>Second of two weighting parameters for the weighted random walk.
Default value is 0.05. Gamma must be in the range [0,1]. Gamma == 0
means that the random walk weights are independent of the discharge
values, and instead are based on the water surface gradient (the
stage). Gamma == 1 means that the random walk weights are not
dependent on the surface gradient, and instead are based on the
inertial forces (the flow discharge).</p>
</dd>
<dt>diff_coeff<span class="classifier"><cite>float</cite></span></dt><dd><p>Diffusion/dispersion coefficient for use in travel time
computation. If set to 0.0, flow is purely advection with no
diffusion. Higher values lead to more spread in exit age
distribution. Max diffusion time in any given step is
0.5*diff_coeff percent. Default value is 0.2 (i.e. max of 10%)</p>
</dd>
<dt>dry_depth<span class="classifier"><cite>float</cite></span></dt><dd><p>Minimum depth for a cell to be considered wet,
default value is 0.1m</p>
</dd>
<dt>cell_type<span class="classifier"><cite>numpy.ndarray</cite></span></dt><dd><p>Array of the different types of cells in the domain where 2 = land,
1 = channel, 0 = ocean, and -1 = edge. If not explicitly defined
then the values are estimated based on the depth array and the
defined dry_depth</p>
</dd>
<dt>steepest_descent<span class="classifier"><cite>bool</cite></span></dt><dd><p>Toggle for routing based on a steepest descent rather than the
weighted random walk. If True, then the highest weighted cells are
used to route the particles. Default value is False.</p>
</dd>
<dt>verbose<span class="classifier"><cite>bool</cite>, optional</span></dt><dd><p>Toggles whether or not warnings and print output are output to the
console. If False, nothing is output, if True, messages are output.
Default value is True. Errors are always raised.</p>
</dd>
</dl>
</div></blockquote>
<p>This list of expected parameter values can also be obtained by querying the
class attributes with <cite>dir(modelParams)</cite>, <cite>modelParams.__dict__</cite>, or
<cite>vars(modelParams)</cite>.</p>
<dl class="method">
<dt id="dorado.particle_track.modelParams.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dorado/particle_track.html#modelParams.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dorado.particle_track.modelParams.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the expected variables for the modelParams class.</p>
<p>Variables are initialized as NoneType they need to be assigned by the
user. Due to the wide variety of data formats produced by differeny
hydrodynamic models, this is process is not automated and must be
handled on a case-by-case basis.</p>
</dd></dl>

<dl class="attribute">
<dt id="dorado.particle_track.modelParams.__weakref__">
<code class="descname">__weakref__</code><a class="headerlink" href="#dorado.particle_track.modelParams.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="dorado.particle_track.nourishment_area">
<code class="descclassname">dorado.particle_track.</code><code class="descname">nourishment_area</code><span class="sig-paren">(</span><em>walk_data</em>, <em>raster_size</em>, <em>sigma=0.7</em>, <em>clip=99.5</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dorado/particle_track.html#nourishment_area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dorado.particle_track.nourishment_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the nourishment area of a particle injection</p>
<p>Function will measure the regions of the domain ‘fed’ by a seed location,
as indicated by the history of particle travel locations in walk_data.
Returns a heatmap raster, in which values indicate number of occasions
each cell was occupied by a particle (after spatial filtering to reduce
noise in the random walk, and normalizing by number of particles).</p>
<p><strong>Inputs</strong> :</p>
<blockquote>
<div><dl>
<dt>walk_data<span class="classifier"><cite>dict</cite></span></dt><dd><p>Dictionary of all prior x locations, y locations, and travel
times (the output of run_iteration)</p>
</dd>
<dt>raster_size<span class="classifier"><cite>tuple</cite></span></dt><dd><p>Tuple (L,W) of the domain dimensions, i.e. the output of
numpy.shape(raster).</p>
</dd>
<dt>sigma<span class="classifier"><cite>float</cite>, optional</span></dt><dd><p>Degree of spatial smoothing of the area, implemented using a
Gaussian kernal of the same sigma, via scipy.ndimage.gaussian_filter
Default is light smoothing with sigma = 0.7 (to turn off smoothing,
set sigma = 0)</p>
</dd>
<dt>clip<span class="classifier"><cite>float</cite>, optional</span></dt><dd><p>Percentile at which to truncate the distribution. Particles which
get stuck can lead to errors at the high-extreme, so this
parameter is used to normalize by a “near-max”. Default is the
99.5th percentile. To use true max, specify clip = 100</p>
</dd>
</dl>
</div></blockquote>
<p><strong>Outputs</strong> :</p>
<blockquote>
<div><dl>
<dt>visit_freq<span class="classifier"><cite>numpy.ndarray</cite></span></dt><dd><p>Array of normalized particle visit frequency, with cells in the
range [0, 1] representing the number of instances particles visited
that cell. If sigma &gt; 0, the array values include spatial filtering</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="dorado.particle_track.nourishment_time">
<code class="descclassname">dorado.particle_track.</code><code class="descname">nourishment_time</code><span class="sig-paren">(</span><em>walk_data</em>, <em>raster_size</em>, <em>sigma=0.7</em>, <em>clip=99.5</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dorado/particle_track.html#nourishment_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dorado.particle_track.nourishment_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the nourishment time of a particle injection</p>
<p>Function will measure the average length of time particles spend in each
area of the domain for a given seed location, as indicated by the history
of particle travel times in walk_data. Returns a heatmap raster, in
which values indicate the average length of time particles tend to remain
in each cell (after spatial filtering to reduce noise in the random walk).</p>
<p><strong>Inputs</strong> :</p>
<blockquote>
<div><dl>
<dt>walk_data<span class="classifier"><cite>dict</cite></span></dt><dd><p>Dictionary of all prior x locations, y locations, and travel
times (the output of run_iteration)</p>
</dd>
<dt>raster_size<span class="classifier"><cite>tuple</cite></span></dt><dd><p>Tuple (L,W) of the domain dimensions, i.e. the output of
numpy.shape(raster).</p>
</dd>
<dt>sigma<span class="classifier"><cite>float</cite>, optional</span></dt><dd><p>Degree of spatial smoothing of the area, implemented using a
Gaussian kernal of the same sigma, via scipy.ndimage.gaussian_filter
Default is light smoothing with sigma = 0.7 (to turn off smoothing,
set sigma = 0)</p>
</dd>
<dt>clip<span class="classifier"><cite>float</cite>, optional</span></dt><dd><p>Percentile at which to truncate the distribution. Particles which
get stuck can lead to errors at the high-extreme, so this
parameter is used to normalize by a “near-max”. Default is the
99.5th percentile. To use true max, specify clip = 100</p>
</dd>
</dl>
</div></blockquote>
<p><strong>Outputs</strong> :</p>
<blockquote>
<div><dl>
<dt>mean_time<span class="classifier"><cite>numpy.ndarray</cite></span></dt><dd><p>Array of mean occupation time, with cell values representing the
mean time particles spent in that cell. If sigma &gt; 0, the array
values include spatial filtering</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="dorado.particle_track.unstruct2grid">
<code class="descclassname">dorado.particle_track.</code><code class="descname">unstruct2grid</code><span class="sig-paren">(</span><em>coordinates</em>, <em>quantity</em>, <em>cellsize</em>, <em>k_nearest_neighbors=3</em>, <em>boundary=None</em>, <em>crop=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dorado/particle_track.html#unstruct2grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dorado.particle_track.unstruct2grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert unstructured model outputs into gridded arrays.</p>
<p>Interpolates model variables (e.g. depth, velocity) from an
unstructured grid onto a Cartesian grid using inverse-distance-weighted
interpolation. Assumes projected (i.e. “flat”) geographic coordinates.
Accepts coordinates in meters or decimal degrees. Extent of output
rasters are based on extent of coordinates.
(Function modeled after ANUGA plot_utils code)</p>
<p><strong>Inputs</strong> :</p>
<blockquote>
<div><dl>
<dt>coordinates<span class="classifier"><cite>list</cite></span></dt><dd><p>List [] of (x,y) pairs or tuples of coordinates at which the
interpolation quantities are located (e.g. centroids or vertices
of an unstructured hydrodynamic model).</p>
</dd>
<dt>quantity<span class="classifier"><cite>list</cite></span></dt><dd><p>List [] of data to be interpolated with indices matching
each (x,y) location given in coordinates. If quantity is
depth, list would be formatted as [d1, d2, … , dn].</p>
</dd>
<dt>cellsize<span class="classifier"><cite>float or int</cite></span></dt><dd><p>Length along one square cell face.</p>
</dd>
<dt>k_nearest_neighbors<span class="classifier"><cite>int</cite>, optional</span></dt><dd><p>Number of nearest neighbors to use in the interpolation.
If k&gt;1, inverse-distance-weighted interpolation is used.</p>
</dd>
<dt>boundary<span class="classifier"><cite>list</cite>, optional</span></dt><dd><p>List [] of (x,y) coordinates used to delineate the boundary of
interpolation. Points outside the polygon will be assigned as nan.
Format needs to match requirements of matplotlib.path.Path()</p>
</dd>
<dt>crop<span class="classifier"><cite>bool</cite>, optional</span></dt><dd><p>If a boundary is specified, setting crop to True will eliminate
any all-NaN borders from the interpolated rasters.</p>
</dd>
</dl>
</div></blockquote>
<p><strong>Outputs</strong> :</p>
<blockquote>
<div><dl>
<dt>interp_func<span class="classifier"><cite>function</cite></span></dt><dd><p>Nearest-neighbor interpolation function for gridding additional
quantities. Quicker to use this output function on additional
variables (e.g. later time-steps of an unsteady model) than
to make additional function calls to unstruct2grid. Function
assumes data have the same coordinates. It is used as follows:
“new_gridded_quantity = interp_func(new_quantity)”.</p>
</dd>
<dt>gridded_quantity<span class="classifier"><cite>numpy.ndarray</cite></span></dt><dd><p>Array of quantity after interpolation.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">dorado</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">Quickstart</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../background/index.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../paper/index.html">Paper</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userguide/index.html">User Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../misc/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/contributing.html">Contributing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../misc/acknowledgments.html">Acknowledgments</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">API Reference</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">API Reference</a></li>
      <li>Next: <a href="lagrangianwalker.html" title="next chapter">dorado.lagrangian_walker</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, J. Hariharan, K. Wright, P. Passalacqua.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/apiref/particletrack.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>